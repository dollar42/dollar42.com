---
title: "ESPP In This Economy?"
description: "Employee Stock Purchase Plans can generate thousands in extra income no matter what happens in the stock market."
date: "2025-04-21"
draft: true
echo: false
image: "image.png"
format:
  html: {}
---

```{dot}
//| fig-cap: An ESPP allows employees to purchase shares at a discount with after-tax money.
//| fig-width: 2
//| fig-height: 5
//| column: margin

digraph G {
    node [shape=plaintext]
    splitrect [
        label=<
            <TABLE BORDER="1" CELLBORDER="1" CELLSPACING="0">
                <TR>
                    <TD ROWSPAN="2" BGCOLOR="lightgreen" WIDTH="35" HEIGHT="80" FIXEDSIZE="TRUE">Profit</TD>
                    <TD BGCOLOR="lightblue" WIDTH="85" HEIGHT="30" FIXEDSIZE="TRUE">Discount</TD>
                </TR>
                <TR>
                    <TD BGCOLOR="lightblue" WIDTH="85" HEIGHT="50" FIXEDSIZE="TRUE">Lookback<br/>(optional)</TD>
                </TR>
                <TR>
                    <TD BGCOLOR="grey" WIDTH="35" HEIGHT="170" FIXEDSIZE="TRUE"></TD>
                    <TD BGCOLOR="grey" WIDTH="85" HEIGHT="170" FIXEDSIZE="TRUE">After-Tax<br/>Contributions</TD>
                </TR>
            </TABLE>
        >
    ]
}
```

Most people misunderstand Employee Stock Purchase Plans (ESPPs).

Even during the COVID stock market crash, I contributed the maximum to my employer's ESPP.

Why? 

No matter how the stock performed, **I earned a 91.57% interest rate on my contributions**.

A "good" ESPP generates hundreds or thousands of extra dollars with little risk. The strategy is simple:

1. Contribute the maximum feasible, respecting other short-term goals.
1. Receive shares at a 5-15% discount every purchase period (typically 3 or 6 months).
1. **Sell the shares immediately and skim the profit as extra income.**
1. Repeat every purchase period.

Selling immediately is crucial because holding the shares long-term is risky for most people.

The _potential_ tax benefit of long-term capital gains rates is not compelling when weighed against the idiosyncratic risk and volatility of a single stock. One bad news story could wipe out the entire profit and more, and it becomes more likely the longer the shares remain unsold^[Some ESPPs restrict employees from selling their purchased shares immediately. That makes participating in the ESPP more risky, and it may be too risky for some people in some cases.].

## Interest Rates

Question: if an ESPP offers a 15% discount on shares every 6 months, is that equivalent to a 15% annualized interest rate in a bank account?

No. **The ESPP earns about 91.57% annualized interest**.

It's a much better deal.

A bank account with a 15% interest rate earns the full 15% only on money present in the account for an entire year.

In the ESPP, money is tied up for 3 months on average (half of the purchase period). With contributions each bimonthly paycheck, the first is escrowed for 6 months, the next for 5.5 months, etc. until the final one is only escrowed for a few days. This averages to 3 months.

The result is a much higher apples-to-apples rate:

$$
\begin{flalign}
r &= \biggl(\frac{A}{P}\biggl)^t - 1 \\
  &= \biggl(\frac{1}{1 - discount}\biggl)^t - 1 \\
  &= \biggl(\frac{1}{0.85}\biggl)^4 - 1\\
  &= 0.9157 \\
  &= 91.57\%
\end{flalign}
$$

<small>$t=4$ because there are 4 3-month quarters in a year.</small>

To calculate ESPP profit for your own plan, try the tool on the right.

```{ojs}
//| panel: sidebar

html `<figcaption>ESPP Interest Rate Calculator</figcaption>`;

viewof purchase_period_in_months = Inputs.select([3, 6, 12], {
  label: "Purchase Period",
  format: (m) => `${m} months`,
  value: 6,
});

viewof discount_percent = Inputs.number([0, Infinity], {
  label: "Discount (%)",
  step: 1,
  value: 15,
});

value_of_stock_per_dollar_contributed = (1.0 / (1.0 - (discount_percent / 100.0)));

html `<hr>`;
html `For every <strong>$1</strong> contributed, <strong>$${value_of_stock_per_dollar_contributed.toFixed(2)}</strong> worth of company stock is purchased`;

average_escrow_time_in_months = purchase_period_in_months / 2.0;
average_escrow_time_in_years = average_escrow_time_in_months / 12.0;
interest_rate = Math.pow(value_of_stock_per_dollar_contributed, 1.0 / average_escrow_time_in_years) - 1.0;

html `<hr>`;
html `On average, money is escrowed for <strong>${average_escrow_time_in_months} months</strong>`;
html `<hr>`;
html `Annualized interest rate: <strong class="fs-1">${(100.0 * interest_rate).toFixed(2)}%</strong>`;
```

## Lookback

The best ESPPs offer a lookback feature.

With a lookback, the discount is applied to the price at the start of an offering period or the price on the purchase date, _whichever is lower_.

"Whichever is lower" makes it difficult to lose.

When the stock rises in value, shares are purchased at a discount from the earlier price, leading to even higher built-in profit.

When the stock falls in value, shares are purchased at a discount from current market price on the purchase date.

There is profit in either scenario as long as the shares are sold immediately to lock it in.

To calculate ESPP profit for your own plan that has a lookback feature, try the tool on the right.

Try different scenarios, including ones where the stock loses value over the purchase period.

```{ojs}
//| panel: sidebar

html `<figcaption>ESPP Interest Rate Calculator</figcaption>`;

viewof lookback_purchase_period_in_months = Inputs.select([3, 6, 12], {
  label: "Purchase Period",
  format: (m) => `${m} months`,
  value: 6,
});

viewof lookback_discount_percent = Inputs.number([0, Infinity], {
  label: "Discount (%)",
  step: 1,
  value: 15,
});

viewof lookback_price_at_start = Inputs.number({
  label: "Stock Price (start)",
  type: "number",
  step: 0.5,
  value: 100,
});

viewof lookback_price_at_purchase = Inputs.number([0, Infinity], {
  label: "Stock Price (purchase date)",
  type: "number",
  step: 0.5,
  value: 105,
});


html `<hr>`;

{
  if (lookback_price_at_start < lookback_price_at_purchase) {
    return html `The stock <strong>rose</strong> in value.<hr>The ${lookback_discount_percent}% discount is applied to the <strong>Stock Price (start)</strong> price.`;
  } else {
    return html `The stock <strong>fell</strong> in value.<hr>The ${lookback_discount_percent}% discount is applied to the <strong>Stock Price (purchase date)</strong> price.`;
  }
}

lookback_purchase_price_with_discount = (1.0 - (lookback_discount_percent / 100.0)) * Math.min(lookback_price_at_start, lookback_price_at_purchase);
html `<hr>`;
html `Each share is purchased for <strong>$${lookback_purchase_price_with_discount.toFixed(2)}</strong> and is immediately worth <strong>$${lookback_price_at_purchase.toFixed(2)}</strong>`;

lookback_average_escrow_time_in_months = lookback_purchase_period_in_months / 2.0;
lookback_average_escrow_time_in_years = lookback_average_escrow_time_in_months / 12.0;
lookback_interest_rate = Math.pow(lookback_price_at_purchase / lookback_purchase_price_with_discount, 1.0 / lookback_average_escrow_time_in_years) - 1.0;

html `<hr>`;
html `Annualized interest rate: <strong class="fs-1">${(100.0 * lookback_interest_rate).toFixed(2)}%</strong>`;
```

## Caveats

ESPP administration and tax law have caveats that change the math in some scenarios. However, I have never seen these issues alone make a plan undesirable.

Capturing the exceptional interest rate requires selling the shares as quickly as possible every time. I set a recurring reminder for myself so I do not forget.

Commissions and fees reduce the effective interest rate slightly.

Some plans allow purchasing partial shares. Others may only allow whole shares; in that case, the "change" will be refunded on a future paycheck.

Qualified (tax efficient) plans under [&sect;423](https://www.law.cornell.edu/uscode/text/26/423) are limited to $25,000 of stock per year. With a 15% discount, the maximum contribution works out to be $21,250.

When a stock rises in value over the offering period, plans with a lookback feature may limit the number of shares that can be purchased. The "change" above and beyond this amount will again be refunded, but it will also lower the effective interest rate.

If an employee is terminated (voluntarily or involuntarily), money contributed during a purchase period will be refunded on their final paycheck or shortly after.

Some plans allow employees to withdraw from the plan during a purchase period and have the money refunded on a future paycheck. There may be significant delay between withdrawing from the plan and receiving the money.

## Planning

How does an  fit into a tax-efficient financial plan? It definitely depends.

But a "good" ESPP likely has a place for anyone wanting to earn an exceptional interest rate in exchange for a locking money up for a short time.

I offer consulting about ESPP and many other tax topics. [Reach out if I can help](/about.html).
