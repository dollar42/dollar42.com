<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-04-22">
<meta name="description" content="Employee Stock Purchase Plans can generate thousands of extra dollars of income at interest rates of 91% or higher.">

<title>ESPP? In This Economy? – Dollar42</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a3a7cb829fb8eee89d3bfc67bf000d32.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "/"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PZZF4E441G"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PZZF4E441G', { 'anonymize_ip': true});
</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script type="text/javascript">
function submitSubscribeForm(e) {
  const subscribeForms = Array.from(document.querySelectorAll(".subscribe-form"));
  subscribeForms.at(-1).submit();
}
</script>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@alindeman">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="ESPP? In This Economy? – Dollar42">
<meta property="og:description" content="Employee Stock Purchase Plans can generate thousands of extra dollars of income at interest rates of 91% or higher.">
<meta property="og:image" content="https://www.dollar42.com/posts/espp-in-this-economy/card.png">
<meta property="og:site_name" content="Dollar42">
<meta property="og:image:height" content="628">
<meta property="og:image:width" content="1200">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.png" alt="Dollar42 logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-info-circle-fill" role="img">
</i> 
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../privacy.html">
 <span class="dropdown-text">Privacy Policy</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../posts/millions-managed-with-a-google-sheet"> <i class="bi bi-file-spreadsheet-fill" role="img">
</i> 
<span class="menu-text">The Spreadsheet</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../subscribe.html"> <i class="bi bi-envelope-at-fill" role="img">
</i> 
<span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ESPP? In This Economy?</h1>
                  <div>
        <div class="description">
          Employee Stock Purchase Plans can generate thousands of extra dollars of income at interest rates of 91% or higher.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 22, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="card text-bg-light">
  <div class="card-body">
    <h5 class="card-title">Subscribe</h5>
    <form class="subscribe-form" method="post" action="https://lists.dollar42.com/subscription/form">
      <input type="hidden" name="l" value="13e77c11-6775-42bb-b371-fc8db830e7bf">

      <div class="mb-1">
        <small class="form-text text-muted">Get emails with new posts from Andy at Dollar42</small>
      </div>
      <div class="mb-1 form-floating">
        <input type="text" class="form-control form-control-sm" name="name">
        <label for="name">Name</label>
      </div>
      <div class="mb-1 form-floating">
        <input type="email" class="form-control form-control-sm" name="email">
        <label for="email">Email</label>
      </div>

      <script src="https://js.hcaptcha.com/1/api.js" async="" defer=""></script>
      <input type="submit" value="Subscribe" class="btn btn-primary h-captcha" data-sitekey="75b2cc2c-0100-44dc-bec4-da6e4156635a" data-callback="submitSubscribeForm">
    </form>
  </div>
</div>

</div></div>
        
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p class="mt-5 mb-0">
<small>Copyright © Dollar 42, LLC</small>
</p>
<p>
<small><a class="text-decoration-none" href="../../about.html"><i class="bi bi-info-circle-fill"></i> about/disclaimer</a></small>
</p>
</div></div></div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="cell page-columns page-full" data-fig-width="2" data-fig-height="5" data-layout-align="default">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 146.00 268.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 264)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-264 142,-264 142,4 -4,4"></polygon>
<!-- splitrect -->
<g id="node1" class="node">
<title>splitrect</title>
<polygon fill="lightgreen" stroke="transparent" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<polygon fill="none" stroke="black" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<text text-anchor="start" x="10.56" y="-210.8" font-family="Times,serif" font-size="14.00">Profit</text>
<polygon fill="lightblue" stroke="transparent" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<polygon fill="none" stroke="black" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<text text-anchor="start" x="61.22" y="-235.8" font-family="Times,serif" font-size="14.00">Discount</text>
<polygon fill="lightblue" stroke="transparent" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<polygon fill="none" stroke="black" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<text text-anchor="start" x="58.51" y="-204.2" font-family="Times,serif" font-size="14.00">Lookback</text>
<text text-anchor="start" x="58.9" y="-187.4" font-family="Times,serif" font-size="14.00">(optional)</text>
<polygon fill="grey" stroke="transparent" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="none" stroke="black" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="grey" stroke="transparent" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<polygon fill="none" stroke="black" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<text text-anchor="start" x="58.52" y="-94.2" font-family="Times,serif" font-size="14.00">After-Tax</text>
<text text-anchor="start" x="48" y="-77.4" font-family="Times,serif" font-size="14.00">Contributions</text>
<polygon fill="none" stroke="black" points="8,-4 8,-256 130,-256 130,-4 8,-4"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> An ESPP allows employees to purchase shares at a discount with after-tax money. There is built-in profit when the shares are purchased.</figcaption> </figure><p></p>
</div>
</div></div></div>
<p>Most people misunderstand Employee Stock Purchase Plans (ESPPs).</p>
<p>Even during the COVID stock market crash, I contributed the maximum to my employer’s ESPP.</p>
<p>As the stock price crashed, <strong>I still earned a 91.57% interest rate on my contributions</strong>.</p>
<p>A good ESPP generates hundreds or thousands of extra dollars with little risk. The strategy is simple:</p>
<ol type="1">
<li>Contribute the maximum feasible, respecting other short-term goals.</li>
<li>Receive shares at a 5–15% discount every purchase period (typically 3 or 6 months).</li>
<li><strong>Sell the shares immediately and skim the profit as extra income.</strong></li>
<li>Repeat every purchase period.</li>
</ol>
<p>Selling immediately is crucial because holding the shares long-term is risky for most people.</p>
<p>The <em>potential</em> tax benefits of long-term ownership are not compelling when weighed against the volatility of a single stock. One bad news story could wipe out the entire profit or even cause a net loss.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<div class="cell w-33-md m-1 p-2 float-end bg-light border border-primary-subtle">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="62" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 61;"><span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;figcaption&gt;ESPP Interest Rate Calculator&lt;/figcaption&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="64" data-source-offset="-65"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 63;"><span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>viewof purchase_period_in_months <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Purchase Period"</span><span class="op">,</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (m) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>m<span class="sc">}</span><span class="vs"> months`</span><span class="op">,</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>viewof discount_percent <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Discount (%)"</span><span class="op">,</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>value_of_stock_per_dollar_contributed <span class="op">=</span> (<span class="fl">1.0</span> <span class="op">/</span> (<span class="fl">1.0</span> <span class="op">-</span> (discount_percent <span class="op">/</span> <span class="fl">100.0</span>)))<span class="op">;</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="79" data-source-offset="-414"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 78;"><span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`For every &lt;strong&gt;$1&lt;/strong&gt; contributed, &lt;strong&gt;$</span><span class="sc">${</span>value_of_stock_per_dollar_contributed<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt; worth of company stock is purchased`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="81" data-source-offset="-572"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 80;"><span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>average_escrow_time_in_months <span class="op">=</span> purchase_period_in_months <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>average_escrow_time_in_years <span class="op">=</span> average_escrow_time_in_months <span class="op">/</span> <span class="fl">12.0</span><span class="op">;</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>interest_rate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(value_of_stock_per_dollar_contributed<span class="op">,</span> <span class="fl">1.0</span> <span class="op">/</span> average_escrow_time_in_years) <span class="op">-</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="86" data-source-offset="-827"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 85;"><span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`On average, money is escrowed for &lt;strong&gt;</span><span class="sc">${</span>average_escrow_time_in_months<span class="sc">}</span><span class="vs"> months&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="87" data-source-offset="-926"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 86;"><span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="88" data-source-offset="-939"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 87;"><span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc">${</span>(<span class="fl">100.0</span> <span class="op">*</span> interest_rate)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><strong>Scenario</strong>: I contributed $850 over 6 months to an ESPP and receive $1,000 worth of stock (15% discount).</p>
<p><strong>Question</strong>: What is the effective annualized interest rate if I sell immediately and receive $1,000 in cash (skimming $150 of profit)?</p>
<p>I think it is 91.57%. Can it really be true?</p>
<p>Consider that if I have $850 in some account and want my balance to be $1,000 in a year, I need a 17.65% interest rate:</p>
<p><span class="math display">\[
\begin{flalign}
A &amp;= P(1 + r) \\
1000 &amp;= 850(1 + r) \\
r &amp;= \frac{1000}{850} - 1 \\
  &amp;= 0.1765 \\
  &amp;= 17.65\%
\end{flalign}
\]</span></p>
<p>It takes a <em>full year</em> at 17.65% interest to generate $150 from $850.</p>
<p>Intuitively the ESPP equivalent rate must be higher than an account paying 17.65% interest.</p>
<p>With ESPP, I contributed $71 twice per month for 6 months (totaling approximately $850).</p>
<p>The first $71 was escrowed for about 6 months, the next $71 for 5.5 months, etc. until the final contribution for only a few days or weeks. On <em>average</em>, one of my dollars was tied up for approximately 3 months (half of the purchase period).</p>
<p>So yes, $850 that turns into $1,000 in 3 months works out to an exceptionally high 91.57% annualized rate:</p>
<p><span class="math display">\[
\begin{flalign}
r &amp;= \biggl(\frac{A}{P}\biggl)^t - 1 \\
  &amp;= \biggl(\frac{1}{1 - discount}\biggl)^t - 1 \\
  &amp;= \biggl(\frac{1}{0.85}\biggl)^4 - 1\\
  &amp;= 0.9157 \\
  &amp;= 91.57\%
\end{flalign}
\]</span></p>
<p><small><span class="math inline">\(t=4\)</span> because there are 4 3-month quarters in a year.</small></p>
<p>To calculate ESPP profit for your own plan, try the tool on the right.</p>
<p>In summary, the ESPP “sticker” discount rate of 5–15% is not the full story!</p>
</section>
<section id="lookback" class="level2">
<h2 class="anchored" data-anchor-id="lookback">Lookback</h2>
<div class="cell w-33-md m-1 p-2 float-end bg-light border border-primary-subtle">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="140" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;figcaption&gt;ESPP Interest Rate Calculator (with lookback)&lt;/figcaption&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="142" data-source-offset="-81"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 141;"><span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>viewof lookback_purchase_period_in_months <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Purchase Period"</span><span class="op">,</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (m) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>m<span class="sc">}</span><span class="vs"> months`</span><span class="op">,</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>viewof lookback_discount_percent <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Discount (%)"</span><span class="op">,</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>viewof lookback_price_at_start <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>({</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Stock Price (start)"</span><span class="op">,</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"number"</span><span class="op">,</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>viewof lookback_price_at_purchase <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Stock Price (purchase date)"</span><span class="op">,</span></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"number"</span><span class="op">,</span></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">105</span><span class="op">,</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="171" data-source-offset="-653"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 170;"><span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lookback_price_at_start <span class="op">&lt;</span> lookback_price_at_purchase) {</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span> <span class="vs">`The stock &lt;strong&gt;rose&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc">${</span>lookback_discount_percent<span class="sc">}</span><span class="vs">% discount is applied to the &lt;strong&gt;Stock Price (start)&lt;/strong&gt; price.`</span><span class="op">;</span></span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span> <span class="vs">`The stock &lt;strong&gt;fell&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc">${</span>lookback_discount_percent<span class="sc">}</span><span class="vs">% discount is applied to the &lt;strong&gt;Stock Price (purchase date)&lt;/strong&gt; price.`</span><span class="op">;</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="179" data-source-offset="-1081"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 178;"><span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>lookback_purchase_price_with_discount <span class="op">=</span> (<span class="fl">1.0</span> <span class="op">-</span> (lookback_discount_percent <span class="op">/</span> <span class="fl">100.0</span>)) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(lookback_price_at_start<span class="op">,</span> lookback_price_at_purchase)<span class="op">;</span></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-9" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="181" data-source-offset="-1243"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 180;"><span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Each share is purchased for &lt;strong&gt;$</span><span class="sc">${</span>lookback_purchase_price_with_discount<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt; and is immediately worth &lt;strong&gt;$</span><span class="sc">${</span>lookback_price_at_purchase<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="183" data-source-offset="-1434"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 182;"><span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>lookback_average_escrow_time_in_months <span class="op">=</span> lookback_purchase_period_in_months <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>lookback_average_escrow_time_in_years <span class="op">=</span> lookback_average_escrow_time_in_months <span class="op">/</span> <span class="fl">12.0</span><span class="op">;</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>lookback_interest_rate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(lookback_price_at_purchase <span class="op">/</span> lookback_purchase_price_with_discount<span class="op">,</span> <span class="fl">1.0</span> <span class="op">/</span> lookback_average_escrow_time_in_years) <span class="op">-</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="188" data-source-offset="-1772"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 187;"><span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc">${</span>(<span class="fl">100.0</span> <span class="op">*</span> lookback_interest_rate)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-15" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>The best ESPPs offer a lookback feature.</p>
<p>With a lookback, the discount is applied to the price at the start of an offering period or the price on the purchase date, <em>whichever is lower</em>.</p>
<p>“Whichever is lower” makes it difficult to lose.</p>
<p>When the stock rises in value, shares are purchased at a discount from the earlier price, leading to even higher built-in profit.</p>
<p>When the stock falls in value, shares are purchased at a discount from the current market price on the purchase date.</p>
<p>There is profit in either scenario as long as the shares are sold immediately to lock in the gain.</p>
<p>To calculate ESPP profit for your own plan that has a lookback feature, try the tool on the right.</p>
<p>Try different scenarios, including ones where the stock loses value over the purchase period. It is still pretty good, right?</p>
<p>A lookback feature, if it exists, will be described in the plan documents.</p>
</section>
<section id="caveats" class="level2">
<h2 class="anchored" data-anchor-id="caveats">Caveats</h2>
<p>ESPP administration and tax law have caveats that change the math in some scenarios. However, I have never seen these issues alone make a plan undesirable.</p>
<p>For instance, volatility in the stock price between the purchase date and when the stock can later be sold means the profit will inevitably be a little higher or lower than the calculators show. I limit the impact of this volatility by having a recurring reminder to sell as quickly as possible.</p>
<p>Commissions and fees reduce the effective interest rate slightly.</p>
<p>Some plans allow purchasing partial shares. Others may only allow whole shares; in that case, the “change” will be refunded on a future paycheck.</p>
<p>Qualified (tax efficient) plans under <a href="https://www.law.cornell.edu/uscode/text/26/423">§423</a> are limited to $25,000 of stock per year<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. With a 15% discount, the maximum contribution works out to be $21,250.</p>
<p>Plans with a lookback feature calculate the maximum number of <em>shares</em> per purchase period from the price at the start of the offering period. If the stock falls in value during this offering period, the maximum number of shares may be worth less than the maximum <em>dollar</em> contribution in later purchase periods. Money that cannot be used to purchase shares will be refunded, but it will also lower the effective interest rate.</p>
<p>Most plans allow employees to withdraw during a purchase period and have the accrued money refunded on a future paycheck. There may be significant delay between withdrawing from the plan and receiving the money.</p>
<p>Some people consider strategically withdrawing based on movement in the stock price. I have yet to see a case where the return on hassle is compelling. ESPP is best left as a mechanical process to generate extra income every purchase period.</p>
<p>If an employee is terminated (voluntarily or involuntarily), money contributed during a purchase period will be refunded on their final paycheck or shortly after.</p>
</section>
<section id="do-you-need-help" class="level2">
<h2 class="anchored" data-anchor-id="do-you-need-help">Do you need help?</h2>
<p>How does an ESPP fit into a tax-efficient financial plan? It will always come down to an individual’s specific goals and circumstances.</p>
<p>But good plans have such a high effective interest rate that anyone who can afford to defer income for a few months may want to consider them.</p>
<p>I offer consulting about ESPP and many other tax topics. <a href="../../about.html">Reach out if I can help</a>.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Some ESPPs restrict employees from selling their purchased shares immediately. That makes participating in the ESPP more risky, and it may be too risky for some people in these cases.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>$25,000 was <a href="https://www.govinfo.gov/content/pkg/STATUTE-78/pdf/STATUTE-78-Pg19.pdf">written into law in 1964</a> and has not changed since. The <a href="https://www.bls.gov/data/inflation_calculator.htm">BLS CPI calculator</a> estimates this amount as $258,737 in today’s dollars as of March 2025.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaHRtbCBgPGZpZ2NhcHRpb24+RVNQUCBJbnRlcmVzdCBSYXRlIENhbGN1bGF0b3I8L2ZpZ2NhcHRpb24+YDtcblxudmlld29mIHB1cmNoYXNlX3BlcmlvZF9pbl9tb250aHMgPSBJbnB1dHMuc2VsZWN0KFszLCA2LCAxMl0sIHtcbiAgbGFiZWw6IFwiUHVyY2hhc2UgUGVyaW9kXCIsXG4gIGZvcm1hdDogKG0pID0+IGAke219IG1vbnRoc2AsXG4gIHZhbHVlOiA2LFxufSk7XG5cbnZpZXdvZiBkaXNjb3VudF9wZXJjZW50ID0gSW5wdXRzLm51bWJlcihbMCwgSW5maW5pdHldLCB7XG4gIGxhYmVsOiBcIkRpc2NvdW50ICglKVwiLFxuICBzdGVwOiAxLFxuICB2YWx1ZTogMTUsXG59KTtcblxudmFsdWVfb2Zfc3RvY2tfcGVyX2RvbGxhcl9jb250cmlidXRlZCA9ICgxLjAgLyAoMS4wIC0gKGRpc2NvdW50X3BlcmNlbnQgLyAxMDAuMCkpKTtcblxuaHRtbCBgPGhyPmA7XG5odG1sIGBGb3IgZXZlcnkgPHN0cm9uZz4kMTwvc3Ryb25nPiBjb250cmlidXRlZCwgPHN0cm9uZz4kJHt2YWx1ZV9vZl9zdG9ja19wZXJfZG9sbGFyX2NvbnRyaWJ1dGVkLnRvRml4ZWQoMil9PC9zdHJvbmc+IHdvcnRoIG9mIGNvbXBhbnkgc3RvY2sgaXMgcHVyY2hhc2VkYDtcblxuYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl9tb250aHMgPSBwdXJjaGFzZV9wZXJpb2RfaW5fbW9udGhzIC8gMi4wO1xuYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl95ZWFycyA9IGF2ZXJhZ2VfZXNjcm93X3RpbWVfaW5fbW9udGhzIC8gMTIuMDtcbmludGVyZXN0X3JhdGUgPSBNYXRoLnBvdyh2YWx1ZV9vZl9zdG9ja19wZXJfZG9sbGFyX2NvbnRyaWJ1dGVkLCAxLjAgLyBhdmVyYWdlX2VzY3Jvd190aW1lX2luX3llYXJzKSAtIDEuMDtcblxuaHRtbCBgPGhyPmA7XG5odG1sIGBPbiBhdmVyYWdlLCBtb25leSBpcyBlc2Nyb3dlZCBmb3IgPHN0cm9uZz4ke2F2ZXJhZ2VfZXNjcm93X3RpbWVfaW5fbW9udGhzfSBtb250aHM8L3N0cm9uZz5gO1xuaHRtbCBgPGhyPmA7XG5odG1sIGBBbm51YWxpemVkIGludGVyZXN0IHJhdGU6IDxzdHJvbmcgY2xhc3M9XCJmcy0xXCI+JHsoMTAwLjAgKiBpbnRlcmVzdF9yYXRlKS50b0ZpeGVkKDIpfSU8L3N0cm9uZz5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5odG1sIGA8ZmlnY2FwdGlvbj5FU1BQIEludGVyZXN0IFJhdGUgQ2FsY3VsYXRvciAod2l0aCBsb29rYmFjayk8L2ZpZ2NhcHRpb24+YDtcblxudmlld29mIGxvb2tiYWNrX3B1cmNoYXNlX3BlcmlvZF9pbl9tb250aHMgPSBJbnB1dHMuc2VsZWN0KFszLCA2LCAxMl0sIHtcbiAgbGFiZWw6IFwiUHVyY2hhc2UgUGVyaW9kXCIsXG4gIGZvcm1hdDogKG0pID0+IGAke219IG1vbnRoc2AsXG4gIHZhbHVlOiA2LFxufSk7XG5cbnZpZXdvZiBsb29rYmFja19kaXNjb3VudF9wZXJjZW50ID0gSW5wdXRzLm51bWJlcihbMCwgSW5maW5pdHldLCB7XG4gIGxhYmVsOiBcIkRpc2NvdW50ICglKVwiLFxuICBzdGVwOiAxLFxuICB2YWx1ZTogMTUsXG59KTtcblxudmlld29mIGxvb2tiYWNrX3ByaWNlX2F0X3N0YXJ0ID0gSW5wdXRzLm51bWJlcih7XG4gIGxhYmVsOiBcIlN0b2NrIFByaWNlIChzdGFydClcIixcbiAgdHlwZTogXCJudW1iZXJcIixcbiAgc3RlcDogMC41LFxuICB2YWx1ZTogMTAwLFxufSk7XG5cbnZpZXdvZiBsb29rYmFja19wcmljZV9hdF9wdXJjaGFzZSA9IElucHV0cy5udW1iZXIoWzAsIEluZmluaXR5XSwge1xuICBsYWJlbDogXCJTdG9jayBQcmljZSAocHVyY2hhc2UgZGF0ZSlcIixcbiAgdHlwZTogXCJudW1iZXJcIixcbiAgc3RlcDogMC41LFxuICB2YWx1ZTogMTA1LFxufSk7XG5cblxuaHRtbCBgPGhyPmA7XG5cbntcbiAgaWYgKGxvb2tiYWNrX3ByaWNlX2F0X3N0YXJ0IDwgbG9va2JhY2tfcHJpY2VfYXRfcHVyY2hhc2UpIHtcbiAgICByZXR1cm4gaHRtbCBgVGhlIHN0b2NrIDxzdHJvbmc+cm9zZTwvc3Ryb25nPiBpbiB2YWx1ZS48aHI+VGhlICR7bG9va2JhY2tfZGlzY291bnRfcGVyY2VudH0lIGRpc2NvdW50IGlzIGFwcGxpZWQgdG8gdGhlIDxzdHJvbmc+U3RvY2sgUHJpY2UgKHN0YXJ0KTwvc3Ryb25nPiBwcmljZS5gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBodG1sIGBUaGUgc3RvY2sgPHN0cm9uZz5mZWxsPC9zdHJvbmc+IGluIHZhbHVlLjxocj5UaGUgJHtsb29rYmFja19kaXNjb3VudF9wZXJjZW50fSUgZGlzY291bnQgaXMgYXBwbGllZCB0byB0aGUgPHN0cm9uZz5TdG9jayBQcmljZSAocHVyY2hhc2UgZGF0ZSk8L3N0cm9uZz4gcHJpY2UuYDtcbiAgfVxufVxuXG5sb29rYmFja19wdXJjaGFzZV9wcmljZV93aXRoX2Rpc2NvdW50ID0gKDEuMCAtIChsb29rYmFja19kaXNjb3VudF9wZXJjZW50IC8gMTAwLjApKSAqIE1hdGgubWluKGxvb2tiYWNrX3ByaWNlX2F0X3N0YXJ0LCBsb29rYmFja19wcmljZV9hdF9wdXJjaGFzZSk7XG5odG1sIGA8aHI+YDtcbmh0bWwgYEVhY2ggc2hhcmUgaXMgcHVyY2hhc2VkIGZvciA8c3Ryb25nPiQke2xvb2tiYWNrX3B1cmNoYXNlX3ByaWNlX3dpdGhfZGlzY291bnQudG9GaXhlZCgyKX08L3N0cm9uZz4gYW5kIGlzIGltbWVkaWF0ZWx5IHdvcnRoIDxzdHJvbmc+JCR7bG9va2JhY2tfcHJpY2VfYXRfcHVyY2hhc2UudG9GaXhlZCgyKX08L3N0cm9uZz5gO1xuXG5sb29rYmFja19hdmVyYWdlX2VzY3Jvd190aW1lX2luX21vbnRocyA9IGxvb2tiYWNrX3B1cmNoYXNlX3BlcmlvZF9pbl9tb250aHMgLyAyLjA7XG5sb29rYmFja19hdmVyYWdlX2VzY3Jvd190aW1lX2luX3llYXJzID0gbG9va2JhY2tfYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl9tb250aHMgLyAxMi4wO1xubG9va2JhY2tfaW50ZXJlc3RfcmF0ZSA9IE1hdGgucG93KGxvb2tiYWNrX3ByaWNlX2F0X3B1cmNoYXNlIC8gbG9va2JhY2tfcHVyY2hhc2VfcHJpY2Vfd2l0aF9kaXNjb3VudCwgMS4wIC8gbG9va2JhY2tfYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl95ZWFycykgLSAxLjA7XG5cbmh0bWwgYDxocj5gO1xuaHRtbCBgQW5udWFsaXplZCBpbnRlcmVzdCByYXRlOiA8c3Ryb25nIGNsYXNzPVwiZnMtMVwiPiR7KDEwMC4wICogbG9va2JhY2tfaW50ZXJlc3RfcmF0ZSkudG9GaXhlZCgyKX0lPC9zdHJvbmc+YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncHVyY2hhc2VfcGVyaW9kX2luX21vbnRocycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkaXNjb3VudF9wZXJjZW50JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2xvb2tiYWNrX3B1cmNoYXNlX3BlcmlvZF9pbl9tb250aHMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbG9va2JhY2tfZGlzY291bnRfcGVyY2VudCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsb29rYmFja19wcmljZV9hdF9zdGFydCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsb29rYmFja19wcmljZV9hdF9wdXJjaGFzZScpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/espp-in-this-economy";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dollar42\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>