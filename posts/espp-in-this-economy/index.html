<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-04-21">
<meta name="description" content="Employee Stock Purchase Plans can generate thousands in extra income no matter what happens in the stock market.">

<title>ESPP In This Economy? – Dollar42</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8dd521c937f9ccb819e9e06aa99567fc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "/"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PZZF4E441G"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PZZF4E441G', { 'anonymize_ip': true});
</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script type="text/javascript">
function submitSubscribeForm(e) {
  document.querySelector(".subscribe-form").submit();
}
</script>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@alindeman">
<meta name="quarto:status" content="draft">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="ESPP In This Economy? – Dollar42">
<meta property="og:description" content="Employee Stock Purchase Plans can generate thousands in extra income no matter what happens in the stock market.">
<meta property="og:image" content="https://www.dollar42.com/posts/espp-in-this-economy/image.png">
<meta property="og:site_name" content="Dollar42">
<meta property="og:image:height" content="800">
<meta property="og:image:width" content="800">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.png" alt="Dollar42 logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-info-circle-fill" role="img">
</i> 
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../privacy.html">
 <span class="dropdown-text">Privacy Policy</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../posts/millions-managed-with-a-google-sheet"> <i class="bi bi-file-spreadsheet-fill" role="img">
</i> 
<span class="menu-text">The Spreadsheet</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../subscribe.html"> <i class="bi bi-envelope-at-fill" role="img">
</i> 
<span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ESPP In This Economy?</h1>
                  <div>
        <div class="description">
          Employee Stock Purchase Plans can generate thousands in extra income no matter what happens in the stock market.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 21, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="card text-bg-light">
  <div class="card-body">
    <h5 class="card-title">Subscribe</h5>
    <form class="subscribe-form" method="post" action="https://lists.dollar42.com/subscription/form">
      <input type="hidden" name="l" value="13e77c11-6775-42bb-b371-fc8db830e7bf">

      <div class="mb-1">
        <small class="form-text text-muted">Get emails with new posts from Andy at Dollar42</small>
      </div>
      <div class="mb-1 form-floating">
        <input type="text" class="form-control form-control-sm" name="name">
        <label for="name">Name</label>
      </div>
      <div class="mb-1 form-floating">
        <input type="email" class="form-control form-control-sm" name="email">
        <label for="email">Email</label>
      </div>

      <script src="https://js.hcaptcha.com/1/api.js" async="" defer=""></script>
      <input type="submit" value="Subscribe" class="btn btn-primary h-captcha" data-sitekey="75b2cc2c-0100-44dc-bec4-da6e4156635a" data-callback="submitSubscribeForm">
    </form>
  </div>
</div>

</div></div>
        
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p class="mt-5 mb-0">
<small>Copyright © Dollar 42, LLC</small>
</p>
<p>
<small><a class="text-decoration-none" href="../../about.html"><i class="bi bi-info-circle-fill"></i> about/disclaimer</a></small>
</p>
</div></div></div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="cell page-columns page-full" data-fig-width="2" data-fig-height="5" data-layout-align="default">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 146.00 268.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 264)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-264 142,-264 142,4 -4,4"></polygon>
<!-- splitrect -->
<g id="node1" class="node">
<title>splitrect</title>
<polygon fill="lightgreen" stroke="transparent" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<polygon fill="none" stroke="black" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<text text-anchor="start" x="10.56" y="-210.8" font-family="Times,serif" font-size="14.00">Profit</text>
<polygon fill="lightblue" stroke="transparent" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<polygon fill="none" stroke="black" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<text text-anchor="start" x="61.22" y="-235.8" font-family="Times,serif" font-size="14.00">Discount</text>
<polygon fill="lightblue" stroke="transparent" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<polygon fill="none" stroke="black" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<text text-anchor="start" x="58.51" y="-204.2" font-family="Times,serif" font-size="14.00">Lookback</text>
<text text-anchor="start" x="58.9" y="-187.4" font-family="Times,serif" font-size="14.00">(optional)</text>
<polygon fill="grey" stroke="transparent" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="none" stroke="black" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="grey" stroke="transparent" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<polygon fill="none" stroke="black" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<text text-anchor="start" x="58.52" y="-94.2" font-family="Times,serif" font-size="14.00">After-Tax</text>
<text text-anchor="start" x="48" y="-77.4" font-family="Times,serif" font-size="14.00">Contributions</text>
<polygon fill="none" stroke="black" points="8,-4 8,-256 130,-256 130,-4 8,-4"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> An ESPP allows employees to purchase shares at a discount with after-tax money.</figcaption> </figure><p></p>
</div>
</div></div></div>
<p>Most people misunderstand Employee Stock Purchase Plans (ESPPs).</p>
<p>Even during the COVID stock market crash, I contributed the maximum to my employer’s ESPP.</p>
<p>Why?</p>
<p>No matter how the stock performed, <strong>I earned a 91.57% interest rate on my contributions</strong>.</p>
<p>A “good” ESPP generates hundreds or thousands of extra dollars with little risk. The strategy is simple:</p>
<ol type="1">
<li>Contribute the maximum feasible, respecting other short-term goals.</li>
<li>Receive shares at a 5–15% discount every purchase period (typically 3 or 6 months).</li>
<li><strong>Sell the shares immediately and skim the profit as extra income.</strong></li>
<li>Repeat every purchase period.</li>
</ol>
<p>Selling immediately is crucial because holding the shares long-term is risky for most people.</p>
<p>The <em>potential</em> tax benefit of long-term capital gains rates is not compelling when weighed against the idiosyncratic risk and volatility of a single stock. One bad news story could wipe out the entire profit and more, and it becomes more likely the longer the shares remain unsold<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<section id="interest-rates" class="level2">
<h2 class="anchored" data-anchor-id="interest-rates">Interest Rates</h2>
<div class="panel-grid layout-sidebar ms-md-0 layout-sidebar-right">
<div class="panel-fill g-col-24 g-col-lg-17 pt-3 pt-lg-0">
<p>Question: if an ESPP offers a 15% discount on shares every 6 months, is that equivalent to a 15% annualized interest rate in a bank account?</p>
<p>No.&nbsp;<strong>The ESPP earns about 91.57% annualized interest</strong>.</p>
<p>It’s a much better deal.</p>
<p>A bank account with a 15% interest rate earns the full 15% only on money present in the account for an entire year.</p>
<p>In the ESPP, money is tied up for 3 months on average (half of the purchase period). With contributions each bimonthly paycheck, the first is escrowed for 6 months, the next for 5.5 months, etc. until the final one is only escrowed for a few days. This averages to 3 months.</p>
<p>The result is a much higher apples-to-apples rate:</p>
<p><span class="math display">\[
\begin{flalign}
r &amp;= \biggl(\frac{A}{P}\biggl)^t - 1 \\
  &amp;= \biggl(\frac{1}{1 - discount}\biggl)^t - 1 \\
  &amp;= \biggl(\frac{1}{0.85}\biggl)^4 - 1\\
  &amp;= 0.9157 \\
  &amp;= 91.57\%
\end{flalign}
\]</span></p>
<p><small><span class="math inline">\(t=4\)</span> because there are 4 3-month quarters in a year.</small></p>
<p>To calculate ESPP profit for your own plan, try the tool on the right.</p>
</div>
<div class="cell panel-sidebar card bg-light p-2 g-col-24 g-col-lg-7">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="90" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 89;"><span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;figcaption&gt;ESPP Interest Rate Calculator&lt;/figcaption&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="92" data-source-offset="-65"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 91;"><span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>viewof purchase_period_in_months <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Purchase Period"</span><span class="op">,</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (m) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>m<span class="sc">}</span><span class="vs"> months`</span><span class="op">,</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>viewof discount_percent <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Discount (%)"</span><span class="op">,</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>value_of_stock_per_dollar_contributed <span class="op">=</span> (<span class="fl">1.0</span> <span class="op">/</span> (<span class="fl">1.0</span> <span class="op">-</span> (discount_percent <span class="op">/</span> <span class="fl">100.0</span>)))<span class="op">;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="107" data-source-offset="-414"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 106;"><span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`For every &lt;strong&gt;$1&lt;/strong&gt; contributed, &lt;strong&gt;$</span><span class="sc">${</span>value_of_stock_per_dollar_contributed<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt; worth of company stock is purchased`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="109" data-source-offset="-572"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 108;"><span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>average_escrow_time_in_months <span class="op">=</span> purchase_period_in_months <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>average_escrow_time_in_years <span class="op">=</span> average_escrow_time_in_months <span class="op">/</span> <span class="fl">12.0</span><span class="op">;</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>interest_rate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(value_of_stock_per_dollar_contributed<span class="op">,</span> <span class="fl">1.0</span> <span class="op">/</span> average_escrow_time_in_years) <span class="op">-</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="114" data-source-offset="-827"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 113;"><span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`On average, money is escrowed for &lt;strong&gt;</span><span class="sc">${</span>average_escrow_time_in_months<span class="sc">}</span><span class="vs"> months&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="115" data-source-offset="-926"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 114;"><span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="116" data-source-offset="-939"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 115;"><span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc">${</span>(<span class="fl">100.0</span> <span class="op">*</span> interest_rate)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</section>
<section id="lookback" class="level2">
<h2 class="anchored" data-anchor-id="lookback">Lookback</h2>
<div class="panel-grid layout-sidebar ms-md-0 layout-sidebar-right">
<div class="panel-fill g-col-24 g-col-lg-17 pt-3 pt-lg-0">
<p>The best ESPPs offer a lookback feature.</p>
<p>With a lookback, the discount is applied to the price at the start of an offering period or the price on the purchase date, <em>whichever is lower</em>.</p>
<p>“Whichever is lower” makes it difficult to lose.</p>
<p>When the stock rises in value, shares are purchased at a discount from the earlier price, leading to even higher built-in profit.</p>
<p>When the stock falls in value, shares are purchased at a discount from the current market price on the purchase date.</p>
<p>There is profit in either scenario as long as the shares are sold immediately to lock it in.</p>
<p>To calculate ESPP profit for your own plan that has a lookback feature, try the tool on the right.</p>
<p>Try different scenarios, including ones where the stock loses value over the purchase period.</p>
</div>
<div class="cell panel-sidebar card bg-light p-2 g-col-24 g-col-lg-7">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="140" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;figcaption&gt;ESPP Interest Rate Calculator&lt;/figcaption&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="142" data-source-offset="-65"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 141;"><span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>viewof lookback_purchase_period_in_months <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Purchase Period"</span><span class="op">,</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (m) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>m<span class="sc">}</span><span class="vs"> months`</span><span class="op">,</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>viewof lookback_discount_percent <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Discount (%)"</span><span class="op">,</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>viewof lookback_price_at_start <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>({</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Stock Price (start)"</span><span class="op">,</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"number"</span><span class="op">,</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>viewof lookback_price_at_purchase <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">number</span>([<span class="dv">0</span><span class="op">,</span> <span class="kw">Infinity</span>]<span class="op">,</span> {</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Stock Price (purchase date)"</span><span class="op">,</span></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"number"</span><span class="op">,</span></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">105</span><span class="op">,</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="171" data-source-offset="-637"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 170;"><span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lookback_price_at_start <span class="op">&lt;</span> lookback_price_at_purchase) {</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span> <span class="vs">`The stock &lt;strong&gt;rose&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc">${</span>lookback_discount_percent<span class="sc">}</span><span class="vs">% discount is applied to the &lt;strong&gt;Stock Price (start)&lt;/strong&gt; price.`</span><span class="op">;</span></span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span> <span class="vs">`The stock &lt;strong&gt;fell&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc">${</span>lookback_discount_percent<span class="sc">}</span><span class="vs">% discount is applied to the &lt;strong&gt;Stock Price (purchase date)&lt;/strong&gt; price.`</span><span class="op">;</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="179" data-source-offset="-1065"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 178;"><span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>lookback_purchase_price_with_discount <span class="op">=</span> (<span class="fl">1.0</span> <span class="op">-</span> (lookback_discount_percent <span class="op">/</span> <span class="fl">100.0</span>)) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(lookback_price_at_start<span class="op">,</span> lookback_price_at_purchase)<span class="op">;</span></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-9" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="181" data-source-offset="-1227"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 180;"><span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Each share is purchased for &lt;strong&gt;$</span><span class="sc">${</span>lookback_purchase_price_with_discount<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt; and is immediately worth &lt;strong&gt;$</span><span class="sc">${</span>lookback_price_at_purchase<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="183" data-source-offset="-1418"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 182;"><span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>lookback_average_escrow_time_in_months <span class="op">=</span> lookback_purchase_period_in_months <span class="op">/</span> <span class="fl">2.0</span><span class="op">;</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>lookback_average_escrow_time_in_years <span class="op">=</span> lookback_average_escrow_time_in_months <span class="op">/</span> <span class="fl">12.0</span><span class="op">;</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>lookback_interest_rate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(lookback_price_at_purchase <span class="op">/</span> lookback_purchase_price_with_discount<span class="op">,</span> <span class="fl">1.0</span> <span class="op">/</span> lookback_average_escrow_time_in_years) <span class="op">-</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`&lt;hr&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="188" data-source-offset="-1756"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 187;"><span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span> <span class="vs">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc">${</span>(<span class="fl">100.0</span> <span class="op">*</span> lookback_interest_rate)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%&lt;/strong&gt;`</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-15" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</section>
<section id="caveats" class="level2">
<h2 class="anchored" data-anchor-id="caveats">Caveats</h2>
<p>ESPP administration and tax law have caveats that change the math in some scenarios. However, I have never seen these issues alone make a plan undesirable.</p>
<p>Capturing the exceptional interest rate requires selling the shares as quickly as possible every time. I set a recurring reminder for myself so I do not forget.</p>
<p>Commissions and fees reduce the effective interest rate slightly.</p>
<p>Some plans allow purchasing partial shares. Others may only allow whole shares; in that case, the “change” will be refunded on a future paycheck.</p>
<p>Qualified (tax efficient) plans under <a href="https://www.law.cornell.edu/uscode/text/26/423">§423</a> are limited to $25,000 of stock per year. With a 15% discount, the maximum contribution works out to be $21,250.</p>
<p>When a stock rises in value over the offering period, plans with a lookback feature may limit the number of shares that can be purchased. The “change” above and beyond this amount will again be refunded, but it will also lower the effective interest rate.</p>
<p>If an employee is terminated (voluntarily or involuntarily), money contributed during a purchase period will be refunded on their final paycheck or shortly after.</p>
<p>Some plans allow employees to withdraw from the plan during a purchase period and have the money refunded on a future paycheck. There may be significant delay between withdrawing from the plan and receiving the money.</p>
</section>
<section id="planning" class="level2">
<h2 class="anchored" data-anchor-id="planning">Planning</h2>
<p>How does an ESPP fit into a tax-efficient financial plan? It definitely depends.</p>
<p>But a “good” ESPP likely has a place for anyone wanting to earn an exceptional interest rate in exchange for a locking money up for a short time.</p>
<p>I offer consulting about ESPP and many other tax topics. <a href="../../about.html">Reach out if I can help</a>.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Some ESPPs restrict employees from selling their purchased shares immediately. That makes participating in the ESPP more risky, and it may be too risky for some people in some cases.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaHRtbCBgPGZpZ2NhcHRpb24+RVNQUCBJbnRlcmVzdCBSYXRlIENhbGN1bGF0b3I8L2ZpZ2NhcHRpb24+YDtcblxudmlld29mIHB1cmNoYXNlX3BlcmlvZF9pbl9tb250aHMgPSBJbnB1dHMuc2VsZWN0KFszLCA2LCAxMl0sIHtcbiAgbGFiZWw6IFwiUHVyY2hhc2UgUGVyaW9kXCIsXG4gIGZvcm1hdDogKG0pID0+IGAke219IG1vbnRoc2AsXG4gIHZhbHVlOiA2LFxufSk7XG5cbnZpZXdvZiBkaXNjb3VudF9wZXJjZW50ID0gSW5wdXRzLm51bWJlcihbMCwgSW5maW5pdHldLCB7XG4gIGxhYmVsOiBcIkRpc2NvdW50ICglKVwiLFxuICBzdGVwOiAxLFxuICB2YWx1ZTogMTUsXG59KTtcblxudmFsdWVfb2Zfc3RvY2tfcGVyX2RvbGxhcl9jb250cmlidXRlZCA9ICgxLjAgLyAoMS4wIC0gKGRpc2NvdW50X3BlcmNlbnQgLyAxMDAuMCkpKTtcblxuaHRtbCBgPGhyPmA7XG5odG1sIGBGb3IgZXZlcnkgPHN0cm9uZz4kMTwvc3Ryb25nPiBjb250cmlidXRlZCwgPHN0cm9uZz4kJHt2YWx1ZV9vZl9zdG9ja19wZXJfZG9sbGFyX2NvbnRyaWJ1dGVkLnRvRml4ZWQoMil9PC9zdHJvbmc+IHdvcnRoIG9mIGNvbXBhbnkgc3RvY2sgaXMgcHVyY2hhc2VkYDtcblxuYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl9tb250aHMgPSBwdXJjaGFzZV9wZXJpb2RfaW5fbW9udGhzIC8gMi4wO1xuYXZlcmFnZV9lc2Nyb3dfdGltZV9pbl95ZWFycyA9IGF2ZXJhZ2VfZXNjcm93X3RpbWVfaW5fbW9udGhzIC8gMTIuMDtcbmludGVyZXN0X3JhdGUgPSBNYXRoLnBvdyh2YWx1ZV9vZl9zdG9ja19wZXJfZG9sbGFyX2NvbnRyaWJ1dGVkLCAxLjAgLyBhdmVyYWdlX2VzY3Jvd190aW1lX2luX3llYXJzKSAtIDEuMDtcblxuaHRtbCBgPGhyPmA7XG5odG1sIGBPbiBhdmVyYWdlLCBtb25leSBpcyBlc2Nyb3dlZCBmb3IgPHN0cm9uZz4ke2F2ZXJhZ2VfZXNjcm93X3RpbWVfaW5fbW9udGhzfSBtb250aHM8L3N0cm9uZz5gO1xuaHRtbCBgPGhyPmA7XG5odG1sIGBBbm51YWxpemVkIGludGVyZXN0IHJhdGU6IDxzdHJvbmcgY2xhc3M9XCJmcy0xXCI+JHsoMTAwLjAgKiBpbnRlcmVzdF9yYXRlKS50b0ZpeGVkKDIpfSU8L3N0cm9uZz5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5odG1sIGA8ZmlnY2FwdGlvbj5FU1BQIEludGVyZXN0IFJhdGUgQ2FsY3VsYXRvcjwvZmlnY2FwdGlvbj5gO1xuXG52aWV3b2YgbG9va2JhY2tfcHVyY2hhc2VfcGVyaW9kX2luX21vbnRocyA9IElucHV0cy5zZWxlY3QoWzMsIDYsIDEyXSwge1xuICBsYWJlbDogXCJQdXJjaGFzZSBQZXJpb2RcIixcbiAgZm9ybWF0OiAobSkgPT4gYCR7bX0gbW9udGhzYCxcbiAgdmFsdWU6IDYsXG59KTtcblxudmlld29mIGxvb2tiYWNrX2Rpc2NvdW50X3BlcmNlbnQgPSBJbnB1dHMubnVtYmVyKFswLCBJbmZpbml0eV0sIHtcbiAgbGFiZWw6IFwiRGlzY291bnQgKCUpXCIsXG4gIHN0ZXA6IDEsXG4gIHZhbHVlOiAxNSxcbn0pO1xuXG52aWV3b2YgbG9va2JhY2tfcHJpY2VfYXRfc3RhcnQgPSBJbnB1dHMubnVtYmVyKHtcbiAgbGFiZWw6IFwiU3RvY2sgUHJpY2UgKHN0YXJ0KVwiLFxuICB0eXBlOiBcIm51bWJlclwiLFxuICBzdGVwOiAwLjUsXG4gIHZhbHVlOiAxMDAsXG59KTtcblxudmlld29mIGxvb2tiYWNrX3ByaWNlX2F0X3B1cmNoYXNlID0gSW5wdXRzLm51bWJlcihbMCwgSW5maW5pdHldLCB7XG4gIGxhYmVsOiBcIlN0b2NrIFByaWNlIChwdXJjaGFzZSBkYXRlKVwiLFxuICB0eXBlOiBcIm51bWJlclwiLFxuICBzdGVwOiAwLjUsXG4gIHZhbHVlOiAxMDUsXG59KTtcblxuXG5odG1sIGA8aHI+YDtcblxue1xuICBpZiAobG9va2JhY2tfcHJpY2VfYXRfc3RhcnQgPCBsb29rYmFja19wcmljZV9hdF9wdXJjaGFzZSkge1xuICAgIHJldHVybiBodG1sIGBUaGUgc3RvY2sgPHN0cm9uZz5yb3NlPC9zdHJvbmc+IGluIHZhbHVlLjxocj5UaGUgJHtsb29rYmFja19kaXNjb3VudF9wZXJjZW50fSUgZGlzY291bnQgaXMgYXBwbGllZCB0byB0aGUgPHN0cm9uZz5TdG9jayBQcmljZSAoc3RhcnQpPC9zdHJvbmc+IHByaWNlLmA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGh0bWwgYFRoZSBzdG9jayA8c3Ryb25nPmZlbGw8L3N0cm9uZz4gaW4gdmFsdWUuPGhyPlRoZSAke2xvb2tiYWNrX2Rpc2NvdW50X3BlcmNlbnR9JSBkaXNjb3VudCBpcyBhcHBsaWVkIHRvIHRoZSA8c3Ryb25nPlN0b2NrIFByaWNlIChwdXJjaGFzZSBkYXRlKTwvc3Ryb25nPiBwcmljZS5gO1xuICB9XG59XG5cbmxvb2tiYWNrX3B1cmNoYXNlX3ByaWNlX3dpdGhfZGlzY291bnQgPSAoMS4wIC0gKGxvb2tiYWNrX2Rpc2NvdW50X3BlcmNlbnQgLyAxMDAuMCkpICogTWF0aC5taW4obG9va2JhY2tfcHJpY2VfYXRfc3RhcnQsIGxvb2tiYWNrX3ByaWNlX2F0X3B1cmNoYXNlKTtcbmh0bWwgYDxocj5gO1xuaHRtbCBgRWFjaCBzaGFyZSBpcyBwdXJjaGFzZWQgZm9yIDxzdHJvbmc+JCR7bG9va2JhY2tfcHVyY2hhc2VfcHJpY2Vfd2l0aF9kaXNjb3VudC50b0ZpeGVkKDIpfTwvc3Ryb25nPiBhbmQgaXMgaW1tZWRpYXRlbHkgd29ydGggPHN0cm9uZz4kJHtsb29rYmFja19wcmljZV9hdF9wdXJjaGFzZS50b0ZpeGVkKDIpfTwvc3Ryb25nPmA7XG5cbmxvb2tiYWNrX2F2ZXJhZ2VfZXNjcm93X3RpbWVfaW5fbW9udGhzID0gbG9va2JhY2tfcHVyY2hhc2VfcGVyaW9kX2luX21vbnRocyAvIDIuMDtcbmxvb2tiYWNrX2F2ZXJhZ2VfZXNjcm93X3RpbWVfaW5feWVhcnMgPSBsb29rYmFja19hdmVyYWdlX2VzY3Jvd190aW1lX2luX21vbnRocyAvIDEyLjA7XG5sb29rYmFja19pbnRlcmVzdF9yYXRlID0gTWF0aC5wb3cobG9va2JhY2tfcHJpY2VfYXRfcHVyY2hhc2UgLyBsb29rYmFja19wdXJjaGFzZV9wcmljZV93aXRoX2Rpc2NvdW50LCAxLjAgLyBsb29rYmFja19hdmVyYWdlX2VzY3Jvd190aW1lX2luX3llYXJzKSAtIDEuMDtcblxuaHRtbCBgPGhyPmA7XG5odG1sIGBBbm51YWxpemVkIGludGVyZXN0IHJhdGU6IDxzdHJvbmcgY2xhc3M9XCJmcy0xXCI+JHsoMTAwLjAgKiBsb29rYmFja19pbnRlcmVzdF9yYXRlKS50b0ZpeGVkKDIpfSU8L3N0cm9uZz5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwdXJjaGFzZV9wZXJpb2RfaW5fbW9udGhzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Rpc2NvdW50X3BlcmNlbnQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbG9va2JhY2tfcHVyY2hhc2VfcGVyaW9kX2luX21vbnRocycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsb29rYmFja19kaXNjb3VudF9wZXJjZW50JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2xvb2tiYWNrX3ByaWNlX2F0X3N0YXJ0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2xvb2tiYWNrX3ByaWNlX2F0X3B1cmNoYXNlJykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/espp-in-this-economy";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.dollar42\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>