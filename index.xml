<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Dollar42</title>
<link>https://www.dollar42.com/</link>
<atom:link href="https://www.dollar42.com/index.xml" rel="self" type="application/rss+xml"/>
<description>simplify dollars, live better</description>
<image>
<url>https://www.dollar42.com/favicon.png</url>
<title>Dollar42</title>
<link>https://www.dollar42.com/</link>
<height>116</height>
<width>44</width>
</image>
<generator>quarto-1.6.43</generator>
<lastBuildDate>Tue, 22 Apr 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>ESPP? In This Economy?</title>
  <link>https://www.dollar42.com/posts/espp-in-this-economy/</link>
  <description><![CDATA[ 





<div class="cell page-columns page-full" data-fig-width="2" data-fig-height="5" data-layout-align="default">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="192" height="480" viewbox="0.00 0.00 146.00 268.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 264)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-264 142,-264 142,4 -4,4"></polygon>
<!-- splitrect -->
<g id="node1" class="node">
<title>splitrect</title>
<polygon fill="lightgreen" stroke="transparent" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<polygon fill="none" stroke="black" points="9,-175 9,-255 44,-255 44,-175 9,-175"></polygon>
<text text-anchor="start" x="10.56" y="-210.8" font-family="Times,serif" font-size="14.00">Profit</text>
<polygon fill="lightblue" stroke="transparent" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<polygon fill="none" stroke="black" points="44,-225 44,-255 129,-255 129,-225 44,-225"></polygon>
<text text-anchor="start" x="61.22" y="-235.8" font-family="Times,serif" font-size="14.00">Discount</text>
<polygon fill="lightblue" stroke="transparent" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<polygon fill="none" stroke="black" points="44,-175 44,-225 129,-225 129,-175 44,-175"></polygon>
<text text-anchor="start" x="58.51" y="-204.2" font-family="Times,serif" font-size="14.00">Lookback</text>
<text text-anchor="start" x="58.9" y="-187.4" font-family="Times,serif" font-size="14.00">(optional)</text>
<polygon fill="grey" stroke="transparent" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="none" stroke="black" points="9,-5 9,-175 44,-175 44,-5 9,-5"></polygon>
<polygon fill="grey" stroke="transparent" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<polygon fill="none" stroke="black" points="44,-5 44,-175 129,-175 129,-5 44,-5"></polygon>
<text text-anchor="start" x="58.52" y="-94.2" font-family="Times,serif" font-size="14.00">After-Tax</text>
<text text-anchor="start" x="48" y="-77.4" font-family="Times,serif" font-size="14.00">Contributions</text>
<polygon fill="none" stroke="black" points="8,-4 8,-256 130,-256 130,-4 8,-4"></polygon>
</g>
</g>
</svg>
</div>
<p></p><figcaption> An ESPP allows employees to purchase shares at a discount with after-tax money. There is built-in profit when the shares are purchased.</figcaption> </figure><p></p>
</div>
</div></div></div>
<p>Most people misunderstand Employee Stock Purchase Plans (ESPPs).</p>
<p>Even during the COVID stock market crash, I contributed the maximum to my employer’s ESPP.</p>
<p>As the stock price crashed, <strong>I still earned a 91.57% interest rate on my contributions</strong>.</p>
<p>A good ESPP generates hundreds or thousands of extra dollars with little risk. The strategy is simple:</p>
<ol type="1">
<li>Contribute the maximum feasible, respecting other short-term goals.</li>
<li>Receive shares at a 5–15% discount every purchase period (typically 3 or 6 months).</li>
<li><strong>Sell the shares immediately and skim the profit as extra income.</strong></li>
<li>Repeat every purchase period.</li>
</ol>
<p>Selling immediately is crucial because holding the shares long-term is risky for most people.</p>
<p>The <em>potential</em> tax benefits of long-term ownership are not compelling when weighed against the volatility of a single stock. One bad news story could wipe out the entire profit or even cause a net loss.<sup>1</sup></p>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<div class="cell w-33-md m-1 p-2 float-end bg-light border border-primary-subtle">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="62" data-source-offset="-1" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 61;"><span id="cb1-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;figcaption&gt;ESPP Interest Rate Calculator&lt;/figcaption&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="64" data-source-offset="-65" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 63;"><span id="cb2-64">viewof purchase_period_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {</span>
<span id="cb2-65">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Purchase Period"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-66">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">format</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> (m) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>m<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;"> months`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-67">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-68">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-69"></span>
<span id="cb2-70">viewof discount_percent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">Infinity</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {</span>
<span id="cb2-71">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Discount (%)"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-72">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-73">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb2-74">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-75"></span>
<span id="cb2-76">value_of_stock_per_dollar_contributed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (discount_percent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100.0</span>)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-77"></span>
<span id="cb2-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="79" data-source-offset="-414" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 78;"><span id="cb3-79"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`For every &lt;strong&gt;$1&lt;/strong&gt; contributed, &lt;strong&gt;$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>value_of_stock_per_dollar_contributed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/strong&gt; worth of company stock is purchased`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="81" data-source-offset="-572" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 80;"><span id="cb4-81">average_escrow_time_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> purchase_period_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-82">average_escrow_time_in_years <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> average_escrow_time_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-83">interest_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pow</span>(value_of_stock_per_dollar_contributed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> average_escrow_time_in_years) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-84"></span>
<span id="cb4-85"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="86" data-source-offset="-827" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 85;"><span id="cb5-86"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`On average, money is escrowed for &lt;strong&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>average_escrow_time_in_months<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;"> months&lt;/strong&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-11" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="87" data-source-offset="-926" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 86;"><span id="cb6-87"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-12" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="88" data-source-offset="-939" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 87;"><span id="cb7-88"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> interest_rate)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">%&lt;/strong&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-13" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><strong>Scenario</strong>: I contributed $850 over 6 months to an ESPP and receive $1,000 worth of stock (15% discount).</p>
<p><strong>Question</strong>: What is the effective annualized interest rate if I sell immediately and receive $1,000 in cash (skimming $150 of profit)?</p>
<p>I think it is 91.57%. Can it really be true?</p>
<p>Consider that if I have $850 in some account and want my balance to be $1,000 in a year, I need a 17.65% interest rate:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bflalign%7D%0AA%20&amp;=%20P(1%20+%20r)%20%5C%5C%0A1000%20&amp;=%20850(1%20+%20r)%20%5C%5C%0Ar%20&amp;=%20%5Cfrac%7B1000%7D%7B850%7D%20-%201%20%5C%5C%0A%20%20&amp;=%200.1765%20%5C%5C%0A%20%20&amp;=%2017.65%5C%25%0A%5Cend%7Bflalign%7D%0A"></p>
<p>It takes a <em>full year</em> at 17.65% interest to generate $150 from $850.</p>
<p>Intuitively the ESPP equivalent rate must be higher than an account paying 17.65% interest.</p>
<p>With ESPP, I contributed $71 twice per month for 6 months (totaling approximately $850).</p>
<p>The first $71 was escrowed for about 6 months, the next $71 for 5.5 months, etc. until the final contribution for only a few days or weeks. On <em>average</em>, one of my dollars was tied up for approximately 3 months (half of the purchase period).</p>
<p>So yes, $850 that turns into $1,000 in 3 months works out to an exceptionally high 91.57% annualized rate:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bflalign%7D%0Ar%20&amp;=%20%5Cbiggl(%5Cfrac%7BA%7D%7BP%7D%5Cbiggl)%5Et%20-%201%20%5C%5C%0A%20%20&amp;=%20%5Cbiggl(%5Cfrac%7B1%7D%7B1%20-%20discount%7D%5Cbiggl)%5Et%20-%201%20%5C%5C%0A%20%20&amp;=%20%5Cbiggl(%5Cfrac%7B1%7D%7B0.85%7D%5Cbiggl)%5E4%20-%201%5C%5C%0A%20%20&amp;=%200.9157%20%5C%5C%0A%20%20&amp;=%2091.57%5C%25%0A%5Cend%7Bflalign%7D%0A"></p>
<p><small><img src="https://latex.codecogs.com/png.latex?t=4"> because there are 4 3-month quarters in a year.</small></p>
<p>To calculate ESPP profit for your own plan, try the tool on the right.</p>
<p>In summary, the ESPP “sticker” discount rate of 5–15% is not the full story!</p>
</section>
<section id="lookback" class="level2">
<h2 class="anchored" data-anchor-id="lookback">Lookback</h2>
<div class="cell w-33-md m-1 p-2 float-end bg-light border border-primary-subtle">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="140" data-source-offset="-1" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="cb8-140"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;figcaption&gt;ESPP Interest Rate Calculator (with lookback)&lt;/figcaption&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="142" data-source-offset="-81" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 141;"><span id="cb9-142">viewof lookback_purchase_period_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {</span>
<span id="cb9-143">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Purchase Period"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-144">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">format</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> (m) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>m<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;"> months`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-145">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-146">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-147"></span>
<span id="cb9-148">viewof lookback_discount_percent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">Infinity</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {</span>
<span id="cb9-149">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Discount (%)"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-150">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-151">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-152">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-153"></span>
<span id="cb9-154">viewof lookback_price_at_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>({</span>
<span id="cb9-155">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stock Price (start)"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-156">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-157">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-158">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-159">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-160"></span>
<span id="cb9-161">viewof lookback_price_at_purchase <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">Infinity</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {</span>
<span id="cb9-162">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stock Price (purchase date)"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-163">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-164">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-165">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">105</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-166">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-167"></span>
<span id="cb9-168"></span>
<span id="cb9-169"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="171" data-source-offset="-653" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 170;"><span id="cb10-171">{</span>
<span id="cb10-172">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (lookback_price_at_start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> lookback_price_at_purchase) {</span>
<span id="cb10-173">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`The stock &lt;strong&gt;rose&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>lookback_discount_percent<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">% discount is applied to the &lt;strong&gt;Stock Price (start)&lt;/strong&gt; price.`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-174">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb10-175">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`The stock &lt;strong&gt;fell&lt;/strong&gt; in value.&lt;hr&gt;The </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>lookback_discount_percent<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">% discount is applied to the &lt;strong&gt;Stock Price (purchase date)&lt;/strong&gt; price.`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-176">  }</span>
<span id="cb10-177">}</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="179" data-source-offset="-1081" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 178;"><span id="cb11-179">lookback_purchase_price_with_discount <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (lookback_discount_percent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100.0</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(lookback_price_at_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lookback_price_at_purchase)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-180"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-9" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="181" data-source-offset="-1243" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 180;"><span id="cb12-181"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`Each share is purchased for &lt;strong&gt;$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>lookback_purchase_price_with_discount<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/strong&gt; and is immediately worth &lt;strong&gt;$</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>lookback_price_at_purchase<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/strong&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-10" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="183" data-source-offset="-1434" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 182;"><span id="cb13-183">lookback_average_escrow_time_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> lookback_purchase_period_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-184">lookback_average_escrow_time_in_years <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> lookback_average_escrow_time_in_months <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-185">lookback_interest_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pow</span>(lookback_price_at_purchase <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> lookback_purchase_price_with_discount<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> lookback_average_escrow_time_in_years) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-186"></span>
<span id="cb13-187"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`&lt;hr&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-14" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="188" data-source-offset="-1772" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 187;"><span id="cb14-188"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`Annualized interest rate: &lt;strong class="fs-1"&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> lookback_interest_rate)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">%&lt;/strong&gt;`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-15" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p>The best ESPPs offer a lookback feature.</p>
<p>With a lookback, the discount is applied to the price at the start of an offering period or the price on the purchase date, <em>whichever is lower</em>.</p>
<p>“Whichever is lower” makes it difficult to lose.</p>
<p>When the stock rises in value, shares are purchased at a discount from the earlier price, leading to even higher built-in profit.</p>
<p>When the stock falls in value, shares are purchased at a discount from the current market price on the purchase date.</p>
<p>There is profit in either scenario as long as the shares are sold immediately to lock in the gain.</p>
<p>To calculate ESPP profit for your own plan that has a lookback feature, try the tool on the right.</p>
<p>Try different scenarios, including ones where the stock loses value over the purchase period. It is still pretty good, right?</p>
<p>A lookback feature, if it exists, will be described in the plan documents.</p>
</section>
<section id="caveats" class="level2">
<h2 class="anchored" data-anchor-id="caveats">Caveats</h2>
<p>ESPP administration and tax law have caveats that change the math in some scenarios. However, I have never seen these issues alone make a plan undesirable.</p>
<p>For instance, volatility in the stock price between the purchase date and when the stock can later be sold means the profit will inevitably be a little higher or lower than the calculators show. I limit the impact of this volatility by having a recurring reminder to sell as quickly as possible.</p>
<p>Commissions and fees reduce the effective interest rate slightly.</p>
<p>Some plans allow purchasing partial shares. Others may only allow whole shares; in that case, the “change” will be refunded on a future paycheck.</p>
<p>Qualified (tax efficient) plans under <a href="https://www.law.cornell.edu/uscode/text/26/423">§423</a> are limited to $25,000 of stock per year<sup>2</sup>. With a 15% discount, the maximum contribution works out to be $21,250.</p>
<p>Plans with a lookback feature calculate the maximum number of <em>shares</em> per purchase period from the price at the start of the offering period. If the stock falls in value during this offering period, the maximum number of shares may be worth less than the maximum <em>dollar</em> contribution in later purchase periods. Money that cannot be used to purchase shares will be refunded, but it will also lower the effective interest rate.</p>
<p>Most plans allow employees to withdraw during a purchase period and have the accrued money refunded on a future paycheck. There may be significant delay between withdrawing from the plan and receiving the money.</p>
<p>Some people consider strategically withdrawing based on movement in the stock price. I have yet to see a case where the return on hassle is compelling. ESPP is best left as a mechanical process to generate extra income every purchase period.</p>
<p>If an employee is terminated (voluntarily or involuntarily), money contributed during a purchase period will be refunded on their final paycheck or shortly after.</p>
</section>
<section id="do-you-need-help" class="level2">
<h2 class="anchored" data-anchor-id="do-you-need-help">Do you need help?</h2>
<p>How does an ESPP fit into a tax-efficient financial plan? It will always come down to an individual’s specific goals and circumstances.</p>
<p>But good plans have such a high effective interest rate that anyone who can afford to defer income for a few months may want to consider them.</p>
<p>I offer consulting about ESPP and many other tax topics. <a href="../../about.html">Reach out if I can help</a>.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Some ESPPs restrict employees from selling their purchased shares immediately. That makes participating in the ESPP more risky, and it may be too risky for some people in these cases.↩︎</p></li>
<li id="fn2"><p>$25,000 was <a href="https://www.govinfo.gov/content/pkg/STATUTE-78/pdf/STATUTE-78-Pg19.pdf">written into law in 1964</a> and has not changed since. The <a href="https://www.bls.gov/data/inflation_calculator.htm">BLS CPI calculator</a> estimates this amount as $258,737 in today’s dollars as of March 2025.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.dollar42.com/posts/espp-in-this-economy/</guid>
  <pubDate>Tue, 22 Apr 2025 00:00:00 GMT</pubDate>
  <media:content url="https://www.dollar42.com/posts/espp-in-this-economy/card.png" medium="image" type="image/png" height="75" width="144"/>
</item>
<item>
  <title>Millions Managed with a Google Sheet</title>
  <link>https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/</link>
  <description><![CDATA[ 





<p>Google Sheets is my primary tool for managing a large index fund portfolio spanning multiple accounts at several institutions.</p>
<p>An early version of my investment spreadsheet is available for feedback as a <a href="https://docs.google.com/spreadsheets/d/1pUflVlVQnK7GzkTGn7WQMZsQdgxwewwoqeI66X-Yt9U/template/preview">free template</a>. This is the first post in a series about the spreadsheet and its development.</p>
<div class="mt-0 callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can subscribe to future posts <a href="../../subscribe.html">via email</a> or <a href="../../index.xml">RSS</a>.</p>
</div>
</div>
</div>
<section id="the-spreadsheet" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-spreadsheet">The Spreadsheet</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Rebalance Matrix (explained later) for Alice and Bob’s example portfolio in the investment spreadsheet"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" class="img-fluid figure-img" alt="Rebalance Matrix for Alice and Bob's example portfolio in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix (explained later) for Alice and Bob’s example portfolio in the investment spreadsheet</figcaption>
</figure>
</div>
<p>My investment philosophy is simple, but it requires a global view of my portfolio spanning all accounts.</p>
<p>I use the spreadsheet to answer several important questions:</p>
<ol type="1">
<li>What funds comprise my entire portfolio spanning all of my accounts? In a simple format, what funds are in my IRA, my spouse’s 401(k), our HSA, a taxable account, etc.?</li>
<li>What is my actual asset allocation spanning all of my accounts?<sup>1</sup></li>
<li>How does my actual asset allocation compare to my target (desired) allocation?</li>
</ol>
<p>And how do I fix things if actual diverges too much from target?</p>
<p>The spreadsheet does not need much information. For Alice and Bob’s example portfolio in this post, I have entered:</p>
<ul>
<li>Account names and types.</li>
<li>Fund symbols and the asset class(es) they represent.</li>
<li>Holdings/transactions: a fund and the number of shares owned per account (e.g., Roth IRA, 936 shares of VTI<sup>2</sup>).</li>
</ul>
<div>

</div>
<div class="column-page quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="accounts.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Accounts"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/accounts.png" class="img-fluid figure-img" alt="Accounts tab in the investment spreadsheet"></a></p>
<figcaption>Accounts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="funds.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Funds"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/funds.png" class="img-fluid figure-img" alt="Funds tab in the investment spreadsheet"></a></p>
<figcaption>Funds</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="transactions.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Transactions"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/transactions.png" class="img-fluid figure-img" alt="Transactions tab in the investment spreadsheet"></a></p>
<figcaption>Transactions</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>With this data filled in, the next tab called Account Holdings automatically generates a report.</p>
<p>The spreadsheet uses the <a href="https://support.google.com/docs/answer/3093281"><code>GOOGLEFINANCE</code> function</a> to dynamically recalculate current values as share prices change over time:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="account_holdings.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Account Holdings"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/account_holdings.png" class="img-fluid figure-img" alt="Account Holdings report in the investment spreadsheet"></a></p>
<figcaption>Account Holdings</figcaption>
</figure>
</div>
<p>I use this report to cross-check against my online statements. If any value is too different, I probably missed entering a transaction into the spreadsheet.</p>
<p>I also print this report to include with my estate plan. It might aid my spouse or executor when they need to inventory accounts when I am incapacitated or die.</p>
</section>
<section id="asset-allocation" class="level2">
<h2 class="anchored" data-anchor-id="asset-allocation">Asset Allocation</h2>
<p>The next tab in the spreadsheet determines target asset allocation. Asset allocation is <a href="https://www.youtube.com/watch?v=p25PPBgMiEk">one of the most important decisions an investor makes</a>.</p>
<p>In this example, Alice and Bob have used formulas to show the thinking behind the ultimately calculated percentages:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="asset_allocation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Asset Allocation"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/asset_allocation.png" class="img-fluid figure-img" alt="Alice and Bob's example asset allocation shown in the investment spreadsheet"></a></p>
<figcaption>Asset Allocation</figcaption>
</figure>
</div>
<p>Their example asset allocation:</p>
<ul>
<li>Reserves $100,000 as a cash buffer off the top.</li>
<li>Invests the rest in 65% stocks (and 35% in bonds by subtraction).</li>
<li>Invests 60% <em>of the stock allocation</em> in US stocks (and 40% in non-US stocks by subtraction).</li>
<li>Invests 30% <em>of the bond allocation</em> in TIPS<sup>3</sup> (and 70% in nominal<sup>4</sup>/nom. bonds by subtraction).</li>
</ul>
<p>In cell B9-C9, $100,000 is automatically calculated as 4.57% of their roughly $2.2 million portfolio. The allocations to all other asset classes are also automatically adjusted downward slightly to account for the cash buffer.</p>
<p>A cash buffer is optional, but I find it important to support in a simple way.</p>
<p>The variable names and values on the right are both editable. In other experiments, I have replaced them with an entirely different set as a way to explore different portfolio constructions.</p>
</section>
<section id="rebalance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="rebalance-matrix">Rebalance Matrix</h2>
<p>With the target asset allocation in place, the next tab called Rebalance Matrix generates a report.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Rebalance Matrix"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" class="img-fluid figure-img" alt="Rebalance Matrix in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix</figcaption>
</figure>
</div>
<p>This report places accounts vertically on the left and asset classes horizontally across the top.</p>
<p>Each cell in the inner matrix pairs a fund with account and asset class.</p>
<p>In cell B12, $257,250 of VTI (a US stock fund) is owned in the Roth IRA (Alice) account and is in the US Stocks asset class. It is the only fund owned in that account.</p>
<p>In cell C14, $310,500 of VXUS (an international stock fund) is owned in the Roth IRA (Bob) account and is in the Int’l Stocks asset class. Similarly, it is the only fund owned in its account.</p>
<p>Different funds in the same asset class are “stacked” vertically. Cells B20-B23 show 65% of VT and 100% of VTI allocated to US Stocks within the Brokerage (Joint) account. 35% of VT, its non-US allocation, is shown in cell C20 under the Int’l Stocks asset class. In total, the Brokerage (Joint) account owns VT, VTI, SCHP and VMFXX.</p>
<p>Looking back toward the top in rows 4-10, Target (% and $) and Actual show target and actual asset class allocations in percent and dollars, summed by column, representing the allocations <em>summed across all accounts</em>.</p>
<p>If target and actual deviate too far, the Difference cells will automatically become more red, indicating that money should ideally start moving from well-performing asset classes to relatively underperforming ones (“sell high, buy low!”).</p>
<p>Alice and Bob probably do <em>not</em> need to rebalance in this example. They are within 1 percentage point of their desired asset allocation in every asset class (row 7). The largest deviation is shown in cell D7 and D10 but is small compared to their portfolio.</p>
<section id="a-different-scenario" class="level3">
<h3 class="anchored" data-anchor-id="a-different-scenario">A Different Scenario</h3>
<p>If I were Alice and Bob, I would open the spreadsheet every few months to add new transactions and check for growing deviations in the Rebalance Matrix. Close monitoring would not be required.</p>
<p>But what if Alice and Bob want to experiment with raising their stock allocation to 75% (from 65%)? In the Asset Allocation sheet:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="stocks_to_75.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Changing the stock allocation to 75%"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/stocks_to_75.png" class="img-fluid figure-img" alt="Changing % Stock allocation to 75% in the investment spreadsheet"></a></p>
<figcaption>Changing the stock allocation to 75%</figcaption>
</figure>
</div>
<p>The Rebalance Matrix sheet automatically regenerates<sup>5</sup>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix_75.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rebalance Matrix with 75% target stock allocation"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix_75.png" class="img-fluid figure-img" alt="Rebalance Matrix showing an unbalanced portfolio in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix with 75% target stock allocation</figcaption>
</figure>
</div>
<p>The story here is much more, er, <em>red</em>.</p>
<p>As expected, Alice and Bob would need to start moving money out of Nom. Bonds and TIPS and into US Stocks and Int’l Stocks.</p>
<p>For example, US stocks are now 5.24 percentage points (cell B7) from target. $114,579 (cell B10) needs to flow from other asset classes into US Stocks to rebalance exactly.</p>
<p>Rebalancing can be a complicated exercise involving personalized circumstances and tax considerations. The spreadsheet lets me quickly experiment with several ideas before executing any trades.</p>
<p>For this example, I will show one possible transaction in what might need to be multiple to fully complete the rebalance:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_in_action.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="A trial rebalance in the Transactions sheet"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_in_action.png" class="img-fluid figure-img" alt="A set of rebalancing transactions in the investment spreadsheet"></a></p>
<figcaption>A trial rebalance in the Transactions sheet</figcaption>
</figure>
</div>
<p>These rows represent an exchange Alice could consider to rebalance from Nom. Bonds and into US Stocks in her Example Corp 401(k):</p>
<ol type="1">
<li>A sale (negative number) of 11,068.335 shares of FXNAX, a fund in the Nom. Bonds category that is currently overweight by $133,486 (cell D10).</li>
<li>Using the sale proceeds, a purchase (positive number) of $115,000 of FSKAX, a US stock fund. $115,000 is a rounded off version of the $114,579 inflow (cell B10) needed to reach the target allocation of US Stocks.</li>
</ol>
<p>I used <code>=115000 / GOOGLEFINANCE("SYMBOL")</code> to get the rough number of shares for $115,000 of each fund at today’s prices. For the sale, I used <code>-115000</code>, a negative number.</p>
<p>If Alice actually executed this transaction, she would later change the values to the exact share counts when the trade settled.</p>
<p>Adding these two transactions causes the Rebalance Matrix to automatically regenerate:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix_after_trade.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rebalance Matrix after the exchange"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix_after_trade.png" class="img-fluid figure-img" alt="Rebalance Matrix after rebalancing showing a more balanced portfolio"></a></p>
<figcaption>Rebalance Matrix after the exchange</figcaption>
</figure>
</div>
<p>In cells B16-D17, the exchange is shown as $115,000 of newly purchased FSKAX (the stock fund) while FXNAX (the bond fund) shows a balance reduced by $115,000 compared to the prior screenshot.</p>
<p>Total balances have not changed because money is only moving from the FXNAX fund to FSKAX, netting to zero in total.</p>
<p>The Difference columns for US Stocks and Nom. Bonds (cells B10 and D10) are noticeably more green.</p>
<p>Although there is more to do with Int’l Stocks and TIPS, this exchange would help get the portfolio closer to alignment with its new target. If it hadn’t or if had I spotted a better sequence of transactions, I could quickly delete the two mock transactions and try something else.</p>
<div class="mt-0 callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Mocking out possible transactions all at once ahead of time has made rebalancing a lot easier for me. It is much quicker in a spreadsheet than other tools I have tried.</strong></p>
</div>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Google Sheets helps me be a better long-term investor. To me that means:</p>
<ol type="1">
<li>Creating an simple investment plan based on sensible principles.</li>
<li>Consistently following the plan and rebalancing occasionally, regardless of the current news or politics.</li>
<li>Ignoring noise from investors playing a different (short-term or irrational) game.</li>
</ol>
<p>The spreadsheet is my attempt to give myself actionable information for my style of investing, without the noise that most commercial tools spam at me when I login.</p>
<div class="mt-0 callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>A portfolio of millions of dollars can be managed with a spreadsheet when it is constructed from a thoughtful handful of good funds representing a small set of diversified asset classes. <strong>Complex investment products or complicated management strategies are not necessarily required even for relatively high portfolio balances.</strong></p>
</div>
</div>
</div>
<p>An early version of the spreadsheet is available as a Google Sheets template here: <a href="https://docs.google.com/spreadsheets/d/1pUflVlVQnK7GzkTGn7WQMZsQdgxwewwoqeI66X-Yt9U/template/preview">Investment Spreadsheet (Google Sheets template)</a>.</p>
<p>I welcome your feedback. Please reach out with your thoughts: <a href="mailto:andy@dollar42.com" class="email">andy@dollar42.com</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For example, what percentage is invested in US stocks relative to other asset classes across <em>all</em> of my accounts?↩︎</p></li>
<li id="fn2"><p>VTI and other funds are used as examples only. Any fund supported by GOOGLEFINANCE can be used. Or worst case, the share price can be provided manually for custom funds or assets.↩︎</p></li>
<li id="fn3"><p>Treasury Inflation Protected Securities: a type of government bond that has some inflation protection features↩︎</p></li>
<li id="fn4"><p>Nominal bonds are not automatically adjusted for inflation. For this example portfolio, nominal bonds mean US bonds <em>excluding</em> TIPS.↩︎</p></li>
<li id="fn5"><p>Sometimes it does not automatically regenerate, but a value in the orange cell B1 can be changed to force it to recalculate↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/</guid>
  <pubDate>Wed, 02 Apr 2025 00:00:00 GMT</pubDate>
  <media:content url="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" medium="image" type="image/png" height="82" width="144"/>
</item>
</channel>
</rss>
