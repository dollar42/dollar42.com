<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Dollar42</title>
<link>https://www.dollar42.com/</link>
<atom:link href="https://www.dollar42.com/index.xml" rel="self" type="application/rss+xml"/>
<description>simplify dollars, live better</description>
<image>
<url>https://www.dollar42.com/favicon.png</url>
<title>Dollar42</title>
<link>https://www.dollar42.com/</link>
<height>116</height>
<width>44</width>
</image>
<generator>quarto-1.6.42</generator>
<lastBuildDate>Wed, 02 Apr 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Millions Managed with a Google Sheet</title>
  <link>https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/</link>
  <description><![CDATA[ 





<p>Google Sheets is my primary tool for managing a large index fund portfolio spanning multiple accounts at several institutions.</p>
<p>An early version of my investment spreadsheet is available for feedback as a <a href="https://docs.google.com/spreadsheets/d/186vSKdp0gJEWqmRKm1ezea9mgBACOBJQ_tc5dOl553c/template/preview">free template</a>. This is the first post in a series about the spreadsheet and its development.</p>
<div class="mt-0 callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can subscribe to future posts <a href="../../subscribe.html">via email</a> or <a href="../../index.xml">RSS</a>.</p>
</div>
</div>
</div>
<section id="the-spreadsheet" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-spreadsheet">The Spreadsheet</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Rebalance Matrix (explained later) for Alice and Bob’s example portfolio in the investment spreadsheet"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" class="img-fluid figure-img" alt="Rebalance Matrix for Alice and Bob's example portfolio in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix (explained later) for Alice and Bob’s example portfolio in the investment spreadsheet</figcaption>
</figure>
</div>
<p>My investment philosophy is simple, but it requires a global view of my portfolio spanning all accounts.</p>
<p>I use the spreadsheet to answer several important questions:</p>
<ol type="1">
<li>What funds comprise my entire portfolio spanning all of my accounts? In a simple format, what funds are in my IRA, my spouse’s 401(k), our HSA, a taxable account, etc.?</li>
<li>What is my actual asset allocation spanning all of my accounts?<sup>1</sup></li>
<li>How does my actual asset allocation compare to my target (desired) allocation?</li>
</ol>
<p>And how do I fix things if actual diverges too much from target?</p>
<p>The spreadsheet does not need much information. For Alice and Bob’s example portfolio in this post, I have entered:</p>
<ul>
<li>Account names and types.</li>
<li>Fund symbols and the asset class(es) they represent.</li>
<li>Holdings/transactions: a fund and the number of shares owned per account (e.g., Roth IRA, 936 shares of VTI<sup>2</sup>).</li>
</ul>
<div>

</div>
<div class="column-page quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="accounts.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Accounts"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/accounts.png" class="img-fluid figure-img" alt="Accounts tab in the investment spreadsheet"></a></p>
<figcaption>Accounts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="funds.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Funds"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/funds.png" class="img-fluid figure-img" alt="Funds tab in the investment spreadsheet"></a></p>
<figcaption>Funds</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="transactions.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Transactions"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/transactions.png" class="img-fluid figure-img" alt="Transactions tab in the investment spreadsheet"></a></p>
<figcaption>Transactions</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>With this data filled in, the next tab called Account Holdings automatically generates a report.</p>
<p>The spreadsheet uses the <a href="https://support.google.com/docs/answer/3093281"><code>GOOGLEFINANCE</code> function</a> to dynamically recalculate current values as share prices change over time:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="account_holdings.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Account Holdings"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/account_holdings.png" class="img-fluid figure-img" alt="Account Holdings report in the investment spreadsheet"></a></p>
<figcaption>Account Holdings</figcaption>
</figure>
</div>
<p>I use this report to cross-check against my online statements. If any value is too different, I probably missed entering a transaction into the spreadsheet.</p>
<p>I also print this report to include with my estate plan. It might aid my spouse or executor when they need to inventory accounts when I am incapacitated or die.</p>
</section>
<section id="asset-allocation" class="level2">
<h2 class="anchored" data-anchor-id="asset-allocation">Asset Allocation</h2>
<p>The next tab in the spreadsheet determines target asset allocation. Asset allocation is <a href="https://www.youtube.com/watch?v=p25PPBgMiEk">one of the most important decisions an investor makes</a>.</p>
<p>In this example, Alice and Bob have used formulas to show the thinking behind the ultimately calculated percentages:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="asset_allocation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Asset Allocation"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/asset_allocation.png" class="img-fluid figure-img" alt="Alice and Bob's example asset allocation shown in the investment spreadsheet"></a></p>
<figcaption>Asset Allocation</figcaption>
</figure>
</div>
<p>Their example asset allocation:</p>
<ul>
<li>Reserves $100,000 as a cash buffer off the top.</li>
<li>Invests the rest in 65% stocks (and 35% in bonds by subtraction).</li>
<li>Invests 60% <em>of the stock allocation</em> in US stocks (and 40% in non-US stocks by subtraction).</li>
<li>Invests 30% <em>of the bond allocation</em> in TIPS<sup>3</sup> (and 70% in nominal<sup>4</sup>/nom. bonds by subtraction).</li>
</ul>
<p>In cell B9-C9, $100,000 is automatically calculated as 4.57% of their roughly $2.2 million portfolio. The allocations to all other asset classes are also automatically adjusted downward slightly to account for the cash buffer.</p>
<p>A cash buffer is optional, but I find it important to support in a simple way.</p>
<p>The variable names and values on the right are both editable. In other experiments, I have replaced them with an entirely different set as a way to explore different portfolio constructions.</p>
</section>
<section id="rebalance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="rebalance-matrix">Rebalance Matrix</h2>
<p>With the target asset allocation in place, the next tab called Rebalance Matrix generates a report.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Rebalance Matrix"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" class="img-fluid figure-img" alt="Rebalance Matrix in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix</figcaption>
</figure>
</div>
<p>This report places accounts vertically on the left and asset classes horizontally across the top.</p>
<p>Each cell in the inner matrix pairs a fund with account and asset class.</p>
<p>In cell B12, $257,250 of VTI (a US stock fund) is owned in the Roth IRA (Alice) account and is in the US Stocks asset class. It is the only fund owned in that account.</p>
<p>In cell C14, $310,500 of VXUS (an international stock fund) is owned in the Roth IRA (Bob) account and is in the Int’l Stocks asset class. Similarly, it is the only fund owned in its account.</p>
<p>Different funds in the same asset class are “stacked” vertically. Cells B20-B23 show 65% of VT and 100% of VTI allocated to US Stocks within the Brokerage (Joint) account. 35% of VT, its non-US allocation, is shown in cell C20 under the Int’l Stocks asset class. In total, the Brokerage (Joint) account owns VT, VTI, SCHP and VMFXX.</p>
<p>Looking back toward the top in rows 4-10, Target (% and $) and Actual show target and actual asset class allocations in percent and dollars, summed by column, representing the allocations <em>summed across all accounts</em>.</p>
<p>If target and actual deviate too far, the Difference cells will automatically become more red, indicating that money should ideally start moving from well-performing asset classes to relatively underperforming ones (“sell high, buy low!”).</p>
<p>Alice and Bob probably do <em>not</em> need to rebalance in this example. They are within 1 percentage point of their desired asset allocation in every asset class (row 7). The largest deviation is shown in cell D7 and D10 but is small compared to their portfolio.</p>
<section id="a-different-scenario" class="level3">
<h3 class="anchored" data-anchor-id="a-different-scenario">A Different Scenario</h3>
<p>If I were Alice and Bob, I would open the spreadsheet every few months to add new transactions and check for growing deviations in the Rebalance Matrix. Close monitoring would not be required.</p>
<p>But what if Alice and Bob want to experiment with raising their stock allocation to 75% (from 65%)? In the Asset Allocation sheet:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="stocks_to_75.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Changing the stock allocation to 75%"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/stocks_to_75.png" class="img-fluid figure-img" alt="Changing % Stock allocation to 75% in the investment spreadsheet"></a></p>
<figcaption>Changing the stock allocation to 75%</figcaption>
</figure>
</div>
<p>The Rebalance Matrix sheet automatically regenerates<sup>5</sup>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix_75.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Rebalance Matrix with 75% target stock allocation"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix_75.png" class="img-fluid figure-img" alt="Rebalance Matrix showing an unbalanced portfolio in the investment spreadsheet"></a></p>
<figcaption>Rebalance Matrix with 75% target stock allocation</figcaption>
</figure>
</div>
<p>The story here is much more, er, <em>red</em>.</p>
<p>As expected, Alice and Bob would need to start moving money out of Nom. Bonds and TIPS and into US Stocks and Int’l Stocks.</p>
<p>For example, US stocks are now 5.24 percentage points (cell B7) from target. $114,579 (cell B10) needs to flow from other asset classes into US Stocks to rebalance exactly.</p>
<p>Rebalancing can be a complicated exercise involving personalized circumstances and tax considerations. The spreadsheet lets me quickly experiment with several ideas before executing any trades.</p>
<p>For this example, I will show one possible transaction in what might need to be multiple to fully complete the rebalance:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_in_action.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="A trial rebalance in the Transactions sheet"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_in_action.png" class="img-fluid figure-img" alt="A set of rebalancing transactions in the investment spreadsheet"></a></p>
<figcaption>A trial rebalance in the Transactions sheet</figcaption>
</figure>
</div>
<p>These rows represent an exchange Alice could consider to rebalance from Nom. Bonds and into US Stocks in her Example Corp 401(k):</p>
<ol type="1">
<li>A sale (negative shares) of -11,068.335 shares of FXNAX, a fund in the Nom. Bonds category that is currently overweight by $133,486 (cell D10).</li>
<li>With the proceeds, a purchase (positive shares) of $115,000 of FSKAX, a US stock fund. $115,000 is a rounded off version of the $114,579 inflow (cell B10) needed to reach the target allocation of US Stocks.</li>
</ol>
<p>I used <code>=115000 / GOOGLEFINANCE("SYMBOL")</code> to get the rough number of shares for $115,000 of each fund at today’s prices. For the sale, I used <code>-115000</code>, a negative number.</p>
<p>If Alice actually executed this transaction, she would later change the values to the exact share counts when the trade settled.</p>
<p>Adding these two transactions causes the Rebalance Matrix to automatically regenerate:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="rebalance_matrix_after_trade.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Rebalance Matrix after the exchange"><img src="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix_after_trade.png" class="img-fluid figure-img" alt="Rebalance Matrix after rebalancing showing a more balanced portfolio"></a></p>
<figcaption>Rebalance Matrix after the exchange</figcaption>
</figure>
</div>
<p>In cells B16-D17, the exchange is shown as $115,000 of newly purchased FSKAX (the stock fund) while FXNAX (the bond fund) shows a balance reduced by $115,000 compared to the prior screenshot.</p>
<p>The Difference columns for US Stocks and Nom. Bonds (cells B10 and D10) are noticeably more green.</p>
<p>Although there is more to do with Int’l Stocks and TIPS, this exchange would help get the portfolio closer to alignment with its new target. If it hadn’t or if had I spotted a better sequence of transactions, I could quickly delete the two mock transactions and try something else.</p>
<div class="mt-0 callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Mocking out possible transactions all at once ahead of time has made rebalancing a lot easier for me. It is much quicker in a spreadsheet than other tools I have tried.</strong></p>
</div>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Google Sheets helps me be a better long-term investor. To me that means:</p>
<ol type="1">
<li>Creating an simple investment plan based on sensible principles.</li>
<li>Sticking to the plan over many decades.</li>
<li>Ignoring noise from investors playing a different (short-term or irrational) game.</li>
</ol>
<p>The spreadsheet is my attempt to give myself actionable information without the noise that most commercial tools spam at me whenever I login.</p>
<div class="mt-0 callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>A portfolio of millions of dollars can be managed with a spreadsheet when it is constructed from a thoughtful handful of good funds representing a small set of diversified asset classes. <strong>Complex investment products or complicated management strategies are not necessarily required even for relatively high portfolio balances.</strong></p>
</div>
</div>
</div>
<p>An early version of the spreadsheet is available as a Google Sheets template here: <a href="https://docs.google.com/spreadsheets/d/186vSKdp0gJEWqmRKm1ezea9mgBACOBJQ_tc5dOl553c/template/preview">Investment Spreadsheet v0.1 (Google Sheets template)</a>.</p>
<p>I welcome your feedback. I read every email: <a href="mailto:andy@dollar42.com" class="email">andy@dollar42.com</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For example, what percentage is invested in US stocks relative to other asset classes across <em>all</em> of my accounts?↩︎</p></li>
<li id="fn2"><p>VTI and other funds are used as examples only. Any fund supported by GOOGLEFINANCE can be used. Or worst case, the share price can be provided manually for custom funds or assets.↩︎</p></li>
<li id="fn3"><p>Treasury Inflation Protected Securities: a type of government bond that has some inflation protection features↩︎</p></li>
<li id="fn4"><p>Nominal bonds are not automatically adjusted for inflation. For this example portfolio, nominal bonds mean US bonds <em>excluding</em> TIPS.↩︎</p></li>
<li id="fn5"><p>Sometimes it does not automatically regenerate, but a value in the orange cell B1 can be changed to force it to recalculate↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/</guid>
  <pubDate>Wed, 02 Apr 2025 00:00:00 GMT</pubDate>
  <media:content url="https://www.dollar42.com/posts/millions-managed-with-a-google-sheet/rebalance_matrix.png" medium="image" type="image/png" height="82" width="144"/>
</item>
</channel>
</rss>
